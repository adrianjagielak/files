<!doctype html>
<html lang="pl">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Twoja Codzienna Motywacja</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 20px;
            }

            .container {
                background: white;
                border-radius: 20px;
                padding: 40px;
                max-width: 600px;
                width: 100%;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            }

            h1 {
                color: #667eea;
                text-align: center;
                margin-bottom: 30px;
                font-size: 2em;
            }

            .api-config {
                background: #f8f9fa;
                padding: 15px;
                border-radius: 10px;
                margin-bottom: 25px;
                border-left: 4px solid #667eea;
            }

            .api-config label {
                display: block;
                font-weight: 600;
                margin-bottom: 5px;
                color: #555;
                font-size: 0.9em;
            }

            .api-config input {
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 5px;
                font-family: monospace;
                font-size: 0.85em;
                margin-bottom: 10px;
            }

            .api-config textarea {
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 5px;
                font-size: 0.85em;
                resize: vertical;
                min-height: 80px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            label {
                display: block;
                margin-bottom: 8px;
                color: #333;
                font-weight: 600;
            }

            input[type="text"],
            textarea {
                width: 100%;
                padding: 12px;
                border: 2px solid #e0e0e0;
                border-radius: 8px;
                font-size: 16px;
                transition: border-color 0.3s;
            }

            input[type="text"]:focus,
            textarea:focus {
                outline: none;
                border-color: #667eea;
            }

            textarea {
                min-height: 100px;
                resize: vertical;
            }

            button {
                width: 100%;
                padding: 15px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                border-radius: 8px;
                font-size: 18px;
                font-weight: 600;
                cursor: pointer;
                transition:
                    transform 0.2s,
                    box-shadow 0.2s;
            }

            button:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
            }

            button:active {
                transform: translateY(0);
            }

            button:disabled {
                opacity: 0.6;
                cursor: not-allowed;
                transform: none;
            }

            .hidden {
                display: none;
            }

            .motivation-content {
                margin-top: 20px;
            }

            .motivation-text {
                background: #f8f9fa;
                padding: 25px;
                border-radius: 12px;
                border-left: 5px solid #667eea;
                margin-bottom: 20px;
                line-height: 1.8;
                color: #333;
                white-space: pre-wrap;
            }

            .affirmation {
                background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
                color: white;
                padding: 20px;
                border-radius: 12px;
                text-align: center;
                font-size: 1.2em;
                font-weight: 600;
                margin-bottom: 20px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            }

            .action-item {
                background: #e8f5e9;
                padding: 20px;
                border-radius: 12px;
                border-left: 5px solid #4caf50;
                margin-bottom: 20px;
            }

            .action-item h3 {
                color: #2e7d32;
                margin-bottom: 10px;
            }

            .button-group {
                display: flex;
                gap: 10px;
                margin-top: 20px;
            }

            .button-group button {
                flex: 1;
            }

            .btn-secondary {
                background: #6c757d;
            }

            .btn-secondary:hover {
                box-shadow: 0 10px 20px rgba(108, 117, 125, 0.3);
            }

            .loading {
                text-align: center;
                padding: 40px;
                color: #667eea;
            }

            .spinner {
                border: 4px solid #f3f3f3;
                border-top: 4px solid #667eea;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                animation: spin 1s linear infinite;
                margin: 0 auto 20px;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            .error {
                background: #ffebee;
                color: #c62828;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
                border-left: 4px solid #c62828;
            }

            .info-text {
                color: #666;
                font-size: 0.9em;
                margin-top: 5px;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <!-- Screen 1: Formularz -->
            <div id="formScreen">
                <h1>üí™ Twoja Codzienna Motywacja</h1>

                <div class="api-config" style="display: none">
                    <label for="apiKey">üîë Klucz API OpenAI (testowy):</label>
                    <input
                        type="text"
                        id="apiKey"
                        placeholder="sk-..."
                        value="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"
                    />

                    <label for="systemPrompt"
                        >üìù System Prompt (testowy):</label
                    >
                    <textarea id="systemPrompt">
Jeste≈õ ekspertem od motywacji i rozwoju osobistego. Tw√≥rz inspirujƒÖce, praktyczne i spersonalizowane tre≈õci motywacyjne w jƒôzyku polskim. BƒÖd≈∫ konkretny, empatyczny i dodaj warto≈õƒá praktycznƒÖ. Struktura odpowiedzi:

1. MOTYWACJA (2-3 zdania inspirujƒÖce dopasowane do sytuacji u≈ºytkownika)
2. AFIRMACJA (jedna mocna afirmacja w pierwszej osobie)
3. DZIA≈ÅANIE (jedno konkretne zadanie do wykonania dzisiaj)</textarea
                    >
                </div>

                <form id="motivationForm">
                    <div class="form-group">
                        <label for="name">üßë Jak masz na imiƒô?</label>
                        <input
                            type="text"
                            id="name"
                            required
                            placeholder="Twoje imiƒô"
                        />
                    </div>

                    <div class="form-group">
                        <label for="feeling">üí≠ Jak siƒô dzisiaj czujesz?</label>
                        <input
                            type="text"
                            id="feeling"
                            required
                            placeholder="np. zmƒôczony, podekscytowany, niezdecydowany..."
                        />
                    </div>

                    <div class="form-group">
                        <label for="goals">üéØ Jakie sƒÖ Twoje cele?</label>
                        <textarea
                            id="goals"
                            required
                            placeholder="Opisz swoje cele, marzenia, to co chcesz osiƒÖgnƒÖƒá..."
                        ></textarea>
                        <div class="info-text">
                            Mo≈ºesz wymieniƒá cele kr√≥tko- i d≈Çugoterminowe
                        </div>
                    </div>

                    <button type="submit">‚ú® Generuj MojƒÖ Motywacjƒô</button>
                </form>
            </div>

            <!-- Screen 2: Tre≈õƒá motywacyjna -->
            <div id="motivationScreen" class="hidden">
                <h1>üí´ Twoja Motywacja na Dzi≈õ</h1>

                <div id="loadingState" class="loading hidden">
                    <div class="spinner"></div>
                    <p>Generujƒô TwojƒÖ spersonalizowanƒÖ motywacjƒô...</p>
                </div>

                <div id="errorState" class="error hidden"></div>

                <div
                    id="motivationContent"
                    class="motivation-content hidden"
                ></div>

                <div class="button-group">
                    <button id="refreshBtn" class="hidden">
                        üîÑ Wygeneruj Ponownie
                    </button>
                    <button id="backBtn" class="btn-secondary">
                        ‚Üê Powr√≥t do Formularza
                    </button>
                </div>
            </div>
        </div>

        <script>
            let userData = {};

            // Domy≈õlny system prompt
            document.getElementById("systemPrompt").value =
                `Jeste≈õ ekspertem od motywacji i rozwoju osobistego. Tw√≥rz inspirujƒÖce, praktyczne i spersonalizowane tre≈õci motywacyjne w jƒôzyku polskim. BƒÖd≈∫ konkretny, empatyczny i dodaj warto≈õƒá praktycznƒÖ. Struktura odpowiedzi:

1. MOTYWACJA (2-3 zdania inspirujƒÖce dopasowane do sytuacji u≈ºytkownika)
2. AFIRMACJA (jedna mocna afirmacja w pierwszej osobie)
3. DZIA≈ÅANIE (jedno konkretne zadanie do wykonania dzisiaj)`;

            document
                .getElementById("motivationForm")
                .addEventListener("submit", async (e) => {
                    e.preventDefault();

                    userData = {
                        name: document.getElementById("name").value,
                        feeling: document.getElementById("feeling").value,
                        goals: document.getElementById("goals").value,
                    };

                    showMotivationScreen();
                    await generateMotivation();
                });

            document
                .getElementById("refreshBtn")
                .addEventListener("click", async () => {
                    await generateMotivation();
                });

            document.getElementById("backBtn").addEventListener("click", () => {
                document
                    .getElementById("formScreen")
                    .classList.remove("hidden");
                document
                    .getElementById("motivationScreen")
                    .classList.add("hidden");
            });

            function showMotivationScreen() {
                document.getElementById("formScreen").classList.add("hidden");
                document
                    .getElementById("motivationScreen")
                    .classList.remove("hidden");
                document
                    .getElementById("loadingState")
                    .classList.remove("hidden");
                document
                    .getElementById("motivationContent")
                    .classList.add("hidden");
                document.getElementById("errorState").classList.add("hidden");
                document.getElementById("refreshBtn").classList.add("hidden");
            }

            async function generateMotivation() {
                const apiKey = document.getElementById("apiKey").value.trim();
                const systemPrompt = document
                    .getElementById("systemPrompt")
                    .value.trim();

                if (!apiKey) {
                    showError("Proszƒô podaƒá klucz API OpenAI");
                    return;
                }

                document
                    .getElementById("loadingState")
                    .classList.remove("hidden");
                document
                    .getElementById("motivationContent")
                    .classList.add("hidden");
                document.getElementById("errorState").classList.add("hidden");

                try {
                    const userPrompt = `Imiƒô: ${userData.name}
Obecne samopoczucie: ${userData.feeling}
Cele: ${userData.goals}

Wygeneruj spersonalizowanƒÖ tre≈õƒá motywacyjnƒÖ na dzi≈õ.`;

                    const response = await fetch(
                        "https://api.openai.com/v1/chat/completions",
                        {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                                Authorization: `Bearer ${apiKey}`,
                            },
                            body: JSON.stringify({
                                model: "gpt-4",
                                messages: [
                                    { role: "system", content: systemPrompt },
                                    { role: "user", content: userPrompt },
                                ],
                                temperature: 0.8,
                                max_tokens: 500,
                            }),
                        },
                    );

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || "B≈ÇƒÖd API");
                    }

                    const data = await response.json();
                    const motivationText = data.choices[0].message.content;

                    displayMotivation(motivationText);
                } catch (error) {
                    showError(
                        `B≈ÇƒÖd: ${error.message}. Sprawd≈∫ klucz API i po≈ÇƒÖczenie internetowe.`,
                    );
                }
            }

            function displayMotivation(text) {
                document.getElementById("loadingState").classList.add("hidden");
                document
                    .getElementById("motivationContent")
                    .classList.remove("hidden");
                document
                    .getElementById("refreshBtn")
                    .classList.remove("hidden");

                // Parsowanie odpowiedzi
                const lines = text.split("\n").filter((line) => line.trim());
                let motivationPart = "";
                let affirmationPart = "";
                let actionPart = "";
                let currentSection = "";

                lines.forEach((line) => {
                    const upper = line.toUpperCase();
                    if (upper.includes("MOTYWACJA") || upper.includes("1.")) {
                        currentSection = "motivation";
                    } else if (
                        upper.includes("AFIRMACJA") ||
                        upper.includes("2.")
                    ) {
                        currentSection = "affirmation";
                    } else if (
                        upper.includes("DZIA≈ÅANIE") ||
                        upper.includes("ZADANIE") ||
                        upper.includes("3.")
                    ) {
                        currentSection = "action";
                    } else if (line.trim()) {
                        const cleanLine = line
                            .replace(/^[123]\.\s*/, "")
                            .replace(
                                /^(MOTYWACJA|AFIRMACJA|DZIA≈ÅANIE|ZADANIE):?\s*/i,
                                "",
                            );
                        if (currentSection === "motivation") {
                            motivationPart += cleanLine + "\n";
                        } else if (currentSection === "affirmation") {
                            affirmationPart += cleanLine + "\n";
                        } else if (currentSection === "action") {
                            actionPart += cleanLine + "\n";
                        }
                    }
                });

                // Je≈õli parsowanie nie zadzia≈Ça≈Ço, wy≈õwietl ca≈Çy tekst
                if (!motivationPart && !affirmationPart && !actionPart) {
                    motivationPart = text;
                }

                let html = `<p style="color: #667eea; font-size: 1.2em; margin-bottom: 20px;">Cze≈õƒá ${userData.name}! üëã</p>`;

                if (motivationPart.trim()) {
                    html += `<div class="motivation-text">${motivationPart.trim()}</div>`;
                }

                if (affirmationPart.trim()) {
                    html += `<div class="affirmation">‚ú® ${affirmationPart.trim()}</div>`;
                }

                if (actionPart.trim()) {
                    html += `<div class="action-item">
                    <h3>üìã Twoje zadanie na dzi≈õ:</h3>
                    <p>${actionPart.trim()}</p>
                </div>`;
                }

                document.getElementById("motivationContent").innerHTML = html;
            }

            function showError(message) {
                document.getElementById("loadingState").classList.add("hidden");
                document
                    .getElementById("errorState")
                    .classList.remove("hidden");
                document.getElementById("errorState").textContent = message;
            }
        </script>
    </body>
</html>
